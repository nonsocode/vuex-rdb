var VuexRdb = (function (t, e) {
  'use strict';
  function n(t) {
    return t && 'object' == typeof t && 'default' in t ? t : { default: t };
  }
  var r = n(e),
    i = function (t, e) {
      return (i =
        Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array &&
          function (t, e) {
            t.__proto__ = e;
          }) ||
        function (t, e) {
          for (var n in e) Object.prototype.hasOwnProperty.call(e, n) && (t[n] = e[n]);
        })(t, e);
    };
  /*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */ function o(
    t,
    e
  ) {
    function n() {
      this.constructor = t;
    }
    i(t, e), (t.prototype = null === e ? Object.create(e) : ((n.prototype = e.prototype), new n()));
  }
  var a = function () {
    return (a =
      Object.assign ||
      function (t) {
        for (var e, n = 1, r = arguments.length; n < r; n++)
          for (var i in (e = arguments[n])) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
        return t;
      }).apply(this, arguments);
  };
  function u(t, e, n, r) {
    var i,
      o = arguments.length,
      a = o < 3 ? e : null === r ? (r = Object.getOwnPropertyDescriptor(e, n)) : r;
    if ('object' == typeof Reflect && 'function' == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, r);
    else for (var u = t.length - 1; u >= 0; u--) (i = t[u]) && (a = (o < 3 ? i(a) : o > 3 ? i(e, n, a) : i(e, n)) || a);
    return o > 3 && a && Object.defineProperty(e, n, a), a;
  }
  function s(t, e, n, r) {
    return new (n || (n = Promise))(function (i, o) {
      function a(t) {
        try {
          s(r.next(t));
        } catch (t) {
          o(t);
        }
      }
      function u(t) {
        try {
          s(r.throw(t));
        } catch (t) {
          o(t);
        }
      }
      function s(t) {
        var e;
        t.done
          ? i(t.value)
          : ((e = t.value),
            e instanceof n
              ? e
              : new n(function (t) {
                  t(e);
                })).then(a, u);
      }
      s((r = r.apply(t, e || [])).next());
    });
  }
  function c(t, e) {
    var n,
      r,
      i,
      o,
      a = {
        label: 0,
        sent: function () {
          if (1 & i[0]) throw i[1];
          return i[1];
        },
        trys: [],
        ops: [],
      };
    return (
      (o = { next: u(0), throw: u(1), return: u(2) }),
      'function' == typeof Symbol &&
        (o[Symbol.iterator] = function () {
          return this;
        }),
      o
    );
    function u(o) {
      return function (u) {
        return (function (o) {
          if (n) throw new TypeError('Generator is already executing.');
          for (; a; )
            try {
              if (
                ((n = 1),
                r &&
                  (i = 2 & o[0] ? r.return : o[0] ? r.throw || ((i = r.return) && i.call(r), 0) : r.next) &&
                  !(i = i.call(r, o[1])).done)
              )
                return i;
              switch (((r = 0), i && (o = [2 & o[0], i.value]), o[0])) {
                case 0:
                case 1:
                  i = o;
                  break;
                case 4:
                  return a.label++, { value: o[1], done: !1 };
                case 5:
                  a.label++, (r = o[1]), (o = [0]);
                  continue;
                case 7:
                  (o = a.ops.pop()), a.trys.pop();
                  continue;
                default:
                  if (!((i = a.trys), (i = i.length > 0 && i[i.length - 1]) || (6 !== o[0] && 2 !== o[0]))) {
                    a = 0;
                    continue;
                  }
                  if (3 === o[0] && (!i || (o[1] > i[0] && o[1] < i[3]))) {
                    a.label = o[1];
                    break;
                  }
                  if (6 === o[0] && a.label < i[1]) {
                    (a.label = i[1]), (i = o);
                    break;
                  }
                  if (i && a.label < i[2]) {
                    (a.label = i[2]), a.ops.push(o);
                    break;
                  }
                  i[2] && a.ops.pop(), a.trys.pop();
                  continue;
              }
              o = e.call(t, a);
            } catch (t) {
              (o = [6, t]), (r = 0);
            } finally {
              n = i = 0;
            }
          if (5 & o[0]) throw o[1];
          return { value: o[0] ? o[1] : void 0, done: !0 };
        })([o, u]);
      };
    }
  }
  function f(t) {
    var e = 'function' == typeof Symbol && Symbol.iterator,
      n = e && t[e],
      r = 0;
    if (n) return n.call(t);
    if (t && 'number' == typeof t.length)
      return {
        next: function () {
          return t && r >= t.length && (t = void 0), { value: t && t[r++], done: !t };
        },
      };
    throw new TypeError(e ? 'Object is not iterable.' : 'Symbol.iterator is not defined.');
  }
  function l(t, e) {
    var n = 'function' == typeof Symbol && t[Symbol.iterator];
    if (!n) return t;
    var r,
      i,
      o = n.call(t),
      a = [];
    try {
      for (; (void 0 === e || e-- > 0) && !(r = o.next()).done; ) a.push(r.value);
    } catch (t) {
      i = { error: t };
    } finally {
      try {
        r && !r.done && (n = o.return) && n.call(o);
      } finally {
        if (i) throw i.error;
      }
    }
    return a;
  }
  function h() {
    for (var t = [], e = 0; e < arguments.length; e++) t = t.concat(l(arguments[e]));
    return t;
  }
  var d = function (t) {
    return t;
  };
  function p(t) {
    return t instanceof Function;
  }
  function v(t) {
    return !0 === t || !1 === t;
  }
  function y(t) {
    return 'string' == typeof t;
  }
  function _(t) {
    var e = Object.create(null);
    return (
      t &&
        Object.entries(t).forEach(function (t) {
          var n = l(t, 2),
            r = n[0],
            i = n[1];
          e[r] = i;
        }),
      e
    );
  }
  var m = function (t, e, n) {
    void 0 === n && (n = void 0);
    var r = t.split('.').reduce(function (t, e) {
      return null === t ? void 0 : t && t[e];
    }, e || _());
    return void 0 === r ? n : r;
  };
  function w(t, e) {
    if (!e) return !1;
    for (; e; ) {
      if (e.item == t) return !0;
      e = e.parentNode;
    }
    return !1;
  }
  var g,
    b,
    A,
    E = (function () {
      function t(t) {
        void 0 === t && (t = {}), (this._default = p(t) ? t() : t.default);
      }
      return (
        Object.defineProperty(t.prototype, 'default', {
          get: function () {
            return p(this._default) ? this._default() : this._default;
          },
          enumerable: !1,
          configurable: !0,
        }),
        t
      );
    })(),
    O = (function (t) {
      function e(e) {
        return void 0 === e && (e = {}), t.call(this, e) || this;
      }
      return o(e, t), e;
    })(E);
  !(function (t) {
    (t.ADD_ALL = 'ADD_ALL'), (t.PATCH_TEMPS = 'PATCH_TEMPS'), (t.SET_PROP = 'SET_PROP');
  })(g || (g = {})),
    (function (t) {
      (t.ADD = 'add'), (t.ADD_RELATED = 'addRelated'), (t.REMOVE_RELATED = 'removeRelated'), (t.UPDATE = 'update');
    })(b || (b = {})),
    (function (t) {
      (t.FIND = 'find'), (t.GET_RAW = 'getRaw'), (t.FIND_BY_IDS = 'findByIds'), (t.ALL = 'all');
    })(A || (A = {}));
  var D = (function (t) {
      function e(e, n) {
        var r = t.call(this) || this;
        return (r.factory = e), (r.parentFactory = n), r;
      }
      return (
        o(e, t),
        Object.defineProperty(e.prototype, 'schema', {
          get: function () {
            return this.factory();
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, 'parentSchema', {
          get: function () {
            var t;
            return null === (t = this.parentFactory) || void 0 === t ? void 0 : t.call(this);
          },
          enumerable: !1,
          configurable: !0,
        }),
        e
      );
    })(E),
    x = (function (t) {
      function e() {
        return (null !== t && t.apply(this, arguments)) || this;
      }
      return o(e, t), e;
    })(D),
    P = (function (t) {
      function e() {
        return (null !== t && t.apply(this, arguments)) || this;
      }
      return o(e, t), e;
    })(D),
    k = (function (t) {
      function e() {
        return (null !== t && t.apply(this, arguments)) || this;
      }
      return o(e, t), e;
    })(x),
    j = (function (t) {
      function e(e, n, r) {
        var i = t.call(this, e, n) || this;
        return (i.foreignKey = r), i;
      }
      return o(e, t), e;
    })(D),
    I = (function (t) {
      function e(e, n, r) {
        var i = t.call(this, e, n) || this;
        return (i.foreignKey = r), i;
      }
      return o(e, t), e;
    })(x);
  function S(t, e, n, r, i) {
    var o, a, u, s, c;
    void 0 === n && (n = new Map()), void 0 === r && (r = new Map());
    var h,
      d = (function (t) {
        return Array.isArray(t) ? t[0] : t.prototype instanceof X ? t : t instanceof D ? t.schema : null;
      })(e),
      p = d._fields;
    if (null == t) h = null;
    else if (
      Array.isArray(t) &&
      (function (t) {
        return Array.isArray(t) || t instanceof x;
      })(e)
    )
      h = t
        .map(function (t) {
          return S(t, d, n, r).result;
        })
        .filter(function (t) {
          return null != t;
        });
    else if (n.has(t)) h = n.get(t);
    else {
      (h = Q(t, d)), n.set(t, h), r.has(d) || r.set(d, _()), r.get(d)[h] || (r.get(d)[h] = {});
      var v = r.get(d)[h],
        y = [];
      try {
        for (var m = f(Object.entries(t)), w = m.next(); !w.done; w = m.next()) {
          var g = l(w.value, 2),
            b = g[0],
            A = g[1];
          b in p && (p[b] instanceof D ? y.push([b, A]) : (v[b] = A));
        }
      } catch (t) {
        o = { error: t };
      } finally {
        try {
          w && !w.done && (a = m.return) && a.call(m);
        } finally {
          if (o) throw o.error;
        }
      }
      var E = function (t, e) {
        var i = p[t],
          o = S(e, p[t], n, r).result;
        switch (!0) {
          case i instanceof P:
          case i instanceof k:
            v[t] = o;
            break;
          case i instanceof I:
            var a = i,
              u = a.schema,
              s = a.foreignKey;
            null === (c = o) ||
              void 0 === c ||
              c.forEach(function (t) {
                r.get(u)[t][s] = h;
              });
            break;
          case i instanceof j:
            var f = i.foreignKey;
            v[f] = o;
        }
      };
      try {
        for (var O = f(y), R = O.next(); !R.done; R = O.next()) {
          var T = l(R.value, 2);
          E((b = T[0]), (A = T[1]));
        }
      } catch (t) {
        u = { error: t };
      } finally {
        try {
          R && !R.done && (s = O.return) && s.call(O);
        } finally {
          if (u) throw u.error;
        }
      }
    }
    return { result: h, entities: r };
  }
  function R(t) {
    return t.constructor;
  }
  function T(t, e, n) {
    var r,
      i,
      o = S(e, n),
      a = o.entities,
      u = o.result;
    try {
      for (var s = f(a.entries()), c = s.next(); !c.done; c = s.next()) {
        var h = l(c.value, 2),
          d = h[0],
          p = h[1];
        t.commit(d._namespace + '/' + g.ADD_ALL, { schema: d, items: p }, { root: !0 });
      }
    } catch (t) {
      r = { error: t };
    } finally {
      try {
        c && !c.done && (i = s.return) && i.call(s);
      } finally {
        if (r) throw r.error;
      }
    }
    return u;
  }
  function L(t, e) {
    var n, r;
    try {
      for (var i = f(t), o = i.next(); !o.done; o = i.next()) {
        if (null == Q(o.value, e))
          throw new Error('An item being assigned to this array does not have a valid identifier');
      }
    } catch (t) {
      n = { error: t };
    } finally {
      try {
        o && !o.done && (r = i.return) && r.call(i);
      } finally {
        if (n) throw n.error;
      }
    }
  }
  function N() {
    return function (t, e, n) {
      var r = n.value;
      n.value = function () {
        for (var t = [], e = 0; e < arguments.length; e++) t[e] = arguments[e];
        var n = this._schema;
        L(t, n), r.apply(this, t);
      };
    };
  }
  var F = (function (t) {
    function e() {
      for (var n = [], r = 0; r < arguments.length; r++) n[r] = arguments[r];
      var i = t.apply(this, h(n)) || this;
      return Object.setPrototypeOf(i, e.prototype), i;
    }
    return (
      o(e, t),
      (e.prototype._init = function (e, n, r) {
        return (
          Object.defineProperties(this, {
            _context: { value: e },
            _key: { value: n },
            _store: { value: R(e)._store },
            _contextSchema: { value: R(e) },
            _schema: { value: R(e)._fields[n].schema },
          }),
          t.prototype.push.apply(this, r),
          this
        );
      }),
      (e.prototype.push = function () {
        for (var e, n = [], r = 0; r < arguments.length; r++) n[r] = arguments[r];
        return (
          T(
            this._store,
            a(a({}, this._context), (((e = {})[this._key] = h(this._allForContext(), n)), e)),
            this._contextSchema
          ),
          t.prototype.splice.apply(this, h([0, this.length], this._context[this._key])),
          this.length
        );
      }),
      (e.prototype.pop = function () {
        var e = t.prototype.pop.call(this);
        return this._remove([e]), e;
      }),
      (e.prototype.unshift = function () {
        for (var e, n = [], r = 0; r < arguments.length; r++) n[r] = arguments[r];
        return (
          T(
            this._store,
            a(a({}, this._context), (((e = {})[this._key] = h(this._allForContext(), n)), e)),
            this._contextSchema
          ),
          t.prototype.splice.apply(this, h([0, this.length], this._context[this._key])),
          this.length
        );
      }),
      (e.prototype.shift = function () {
        var e = t.prototype.shift.call(this);
        return this._remove([e]), e;
      }),
      (e.prototype.splice = function () {
        for (var e, n = [], r = 0; r < arguments.length; r++) n[r] = arguments[r];
        var i = l(n),
          o = i[0],
          u = i[1],
          s = i.slice(2),
          c = 0 === n.length ? [] : t.prototype.splice.apply(this, h([o, u], s));
        return (
          this._remove(c),
          T(
            this._store,
            a(a({}, this._context), (((e = {})[this._key] = h(this._allForContext(), s)), e)),
            this._contextSchema
          ),
          c
        );
      }),
      (e.prototype.toPlainArray = function () {
        return h(this).map(function (t) {
          return t instanceof X ? t.$toObject() : t;
        });
      }),
      (e.prototype._remove = function (t) {
        if (t.length) {
          var e = this._schema,
            n = this._key,
            r = this._contextSchema._fields[n],
            i = this._allForContext(),
            o = t.map(function (t) {
              return Q(t, e);
            });
          switch (!0) {
            case r instanceof k:
              var a = i
                .map(function (t) {
                  return Q(t, e);
                })
                .filter(function (t) {
                  return !o.includes(t);
                });
              this._mutateContext(a);
              break;
            case r instanceof I:
              e.findByIds(o).forEach(function (t) {
                return (t[r.foreignKey] = null);
              });
          }
        }
      }),
      (e.prototype._allForContext = function () {
        var t;
        return (
          (null === (t = this._contextSchema.find(this._context._id)) || void 0 === t ? void 0 : t[this._key]) || []
        );
      }),
      (e.prototype._mutateContext = function (t) {
        this._store.commit(this._contextSchema._namespace + '/' + g.SET_PROP, {
          id: this._context._id,
          key: this._key,
          value: t,
          schema: this._contextSchema,
        });
      }),
      u([N()], e.prototype, 'push', null),
      u([N()], e.prototype, 'unshift', null),
      u(
        [
          function (t, e, n) {
            var r = n.value;
            n.value = function () {
              for (var t = [], e = 0; e < arguments.length; e++) t[e] = arguments[e];
              var n = this._schema,
                i = l(t),
                o = i.slice(2);
              o.length && L(o, n), r.apply(this, t);
            };
          },
        ],
        e.prototype,
        'splice',
        null
      ),
      e
    );
  })(Array);
  window.ModelArray = F;
  var M = (function (t) {
      function e(e) {
        var n = t.call(this) || this;
        return (n.context = e), n;
      }
      return (
        o(e, t),
        (e.prototype.matchItem = function (t) {
          if (!this.whereAnds.length && !this.whereOrs.length) return !0;
          var e = [],
            n = C(t);
          return (
            e.push(!(!this.whereAnds.length || !this.whereAnds.every(n))),
            e.push(!(!this.whereOrs.length || !this.whereOrs.some(n))),
            e.some(d)
          );
        }),
        (e.prototype.get = function () {
          return this.matchItem(this.context);
        }),
        e
      );
    })(
      (function () {
        function t() {
          (this.whereAnds = []), (this.whereOrs = []);
        }
        return (
          (t.prototype.where = function () {
            for (var t = [], e = 0; e < arguments.length; e++) t[e] = arguments[e];
            return this.addWhere.apply(this, h(['and'], t)), this;
          }),
          (t.prototype.orWhere = function () {
            for (var t = [], e = 0; e < arguments.length; e++) t[e] = arguments[e];
            return this.addWhere.apply(this, h(['or'], t)), this;
          }),
          (t.prototype.addWhere = function (t) {
            for (var e = [], n = 1; n < arguments.length; n++) e[n - 1] = arguments[n];
            var r = 'and' == t ? this.whereAnds : this.whereOrs;
            switch (e.length) {
              case 1:
                if (!p(e[0]) && !v(e[0])) throw new Error('Argument should be a function or boolean');
                v(e[0]) ? r.push({ operand: e[0] }) : r.push({ key: e[0] });
                break;
              case 2:
                r.push({ key: e[0], value: e[1] });
                break;
              case 3:
                r.push({ key: e[0], operand: e[1], value: e[2] });
                break;
              default:
                throw new Error('Illegal arguments supplied');
            }
          }),
          t
        );
      })()
    ),
    C = function (t) {
      return function (e) {
        if (p(e.key)) {
          var n = new M(t);
          return 'boolean' == typeof (r = e.key.call(null, n, t)) ? r : n.get();
        }
        if (y(e.key) && p(e.value)) {
          var r,
            i = m(e.key, t);
          n = new M(i);
          return 'boolean' == typeof (r = e.value.call(null, n, i)) ? r : n.get();
        }
        if (v(e.operand)) return e.operand;
        if (y(e.key) && !p(e.value)) {
          var o = m(e.key, t);
          switch (((o = Array.isArray(o) ? o.length : o), e.operand)) {
            case '!=':
              return o != e.value;
            case '>':
              return o > e.value;
            case '>=':
              return o >= e.value;
            case '<':
              return o < e.value;
            case '<=':
              return o <= e.value;
            case '=':
            default:
              return o == e.value;
          }
        }
      };
    },
    $ = function (t, e, n, r) {
      if (n.has(t)) r.push(n.getLoad(t));
      else {
        var i = new U(e);
        n.addLoad(t, i), r.push(i);
      }
    };
  function B(t, e) {
    var n,
      r,
      i = [],
      o = function (t) {
        var n = t.getRelationship().schema;
        '*' === e
          ? Object.entries(n._fields)
              .filter(function (t) {
                return l(t, 2)[1] instanceof D;
              })
              .forEach(function (e) {
                var n = l(e, 2),
                  r = n[0],
                  o = n[1];
                $(r, o, t, i);
              })
          : n._fields[e] && n._fields[e] instanceof D
          ? $(e, n._fields[e], t, i)
          : console.warn('[' + e + '] is not a relationship');
      };
    try {
      for (var a = f(t), u = a.next(); !u.done; u = a.next()) {
        o(u.value);
      }
    } catch (t) {
      n = { error: t };
    } finally {
      try {
        u && !u.done && (r = a.return) && r.call(a);
      } finally {
        if (n) throw n.error;
      }
    }
    return i;
  }
  var K = (function (t) {
      function e(e) {
        var n = t.call(this) || this;
        return (n.load = e), (n.whereHasAnds = []), (n.whereHasOrs = []), n;
      }
      return (
        o(e, t),
        (e.prototype.with = function () {
          for (var t = [], e = 0; e < arguments.length; e++) t[e] = arguments[e];
          switch (t.length) {
            case 1:
            case 2:
              this.load.parse(t[0], t[1]);
              break;
            default:
              throw new Error('Invalid arguments supplied');
          }
          return this;
        }),
        (e.prototype.get = function () {
          throw new Error('Method not implemented.');
        }),
        e
      );
    })(M),
    U = (function () {
      function t(t) {
        (this.relationship = t), (this.loads = new Map()), (this.conditions = new Set());
      }
      return (
        (t.prototype.addLoad = function (t, e) {
          this.loads.set(t, e);
        }),
        (t.prototype.getLoad = function (t) {
          return this.loads.get(t);
        }),
        (t.prototype.has = function (t) {
          return this.loads.has(t);
        }),
        (t.prototype.addCondition = function (t) {
          this.conditions.add(t);
        }),
        (t.prototype.apply = function (t) {
          if (0 == this.conditions.size || null == t) return t;
          var e = h(this.conditions);
          return this.relationship instanceof x
            ? t.filter(function (t) {
                return e.some(function (e) {
                  return e.matchItem(t);
                });
              })
            : e.some(function (e) {
                return e.matchItem(t);
              })
            ? t
            : void 0;
        }),
        (t.prototype.getRelationship = function () {
          return this.relationship;
        }),
        (t.prototype.parse = function () {
          for (var t = this, e = [], n = 0; n < arguments.length; n++) e[n] = arguments[n];
          var r = this.parseRawLoadArgs.apply(this, h(e));
          return (
            Object.entries(r).forEach(function (e) {
              var n = l(e, 2),
                r = n[0],
                i = n[1];
              r.split('.')
                .reduce(
                  function (t, e) {
                    return B(t, e);
                  },
                  [t]
                )
                .forEach(function (t) {
                  if (p(i)) {
                    var e = new K(t);
                    i.call(null, e), t.addCondition(e);
                  }
                });
            }),
            this
          );
        }),
        (t.prototype.parseRawLoadArgs = function () {
          for (var t = [], e = 0; e < arguments.length; e++) t[e] = arguments[e];
          var n = _(),
            r = l(t, 2),
            i = r[0],
            o = r[1];
          switch (t.length) {
            case 1:
              Array.isArray(i)
                ? i.forEach(function (t) {
                    return (n[t] = !0);
                  })
                : y
                ? (n[i] = !0)
                : (n = _(i));
              break;
            case 2:
              n[i] = o;
              break;
            default:
              throw new Error('Invalid arguments supplied');
          }
          return n;
        }),
        t
      );
    })(),
    W = (function (t) {
      function e(e) {
        var n = t.call(this, null) || this;
        return (n.schema = e), (n.withArgs = []), n;
      }
      return (
        o(e, t),
        (e.prototype.with = function () {
          for (var t = [], e = 0; e < arguments.length; e++) t[e] = arguments[e];
          return this.withArgs.push(t), this;
        }),
        (e.prototype.initLoad = function () {
          var t = this;
          return (
            this.load ||
              (this.load = new U(
                new P(function () {
                  return t.schema;
                })
              )),
            this.load
          );
        }),
        (e.prototype.get = function () {
          var e = this,
            n = this.schema.all();
          return (
            (n = n.filter(function (t) {
              return e.matchItem(t);
            })).length &&
              (this.withArgs.length &&
                (this.initLoad(),
                this.withArgs.forEach(function (n) {
                  var r = l(n, 2),
                    i = r[0],
                    o = r[1];
                  t.prototype.with.call(e, i, o);
                })),
              (n = n.map(function (t) {
                return e.schema.find(Q(t, e.schema), { load: e.load });
              }))),
            n
          );
        }),
        e
      );
    })(K);
  function Y(t, e) {
    return function (n, r) {
      var i = n.constructor;
      null == i._fields && (i._fields = _()),
        r in i._fields ||
          (i._fields[r] = Y.define(
            t,
            function () {
              return i;
            },
            e
          ));
    };
  }
  function G(t, e) {
    return function (n, r) {
      var i = n.constructor;
      null == i._fields && (i._fields = _()),
        r in i._fields ||
          (i._fields[r] = G.define(
            t,
            function () {
              return i;
            },
            e
          ));
    };
  }
  (Y.define = function (t, e, n) {
    return new j(t, e, n);
  }),
    (G.define = function (t, e, n) {
      return new I(t, e, n);
    });
  var H = ['data', 'relationship'],
    J = function (t) {
      return H[t ? 1 : 0];
    },
    V = function (t, e) {
      return ['string', 'number'].includes(typeof t) ? e.find(t) : t;
    };
  function z(t, e, n, r, i) {
    var o,
      u,
      s = i._store,
      c = i._namespace,
      f = i.id;
    if (r) {
      var l = r.schema;
      if (
        ((n = V(n, l)),
        r instanceof x && null != n && (n = Array.isArray(n) ? n : [n].filter(d)),
        null != n &&
          !(function (t, e) {
            var n = e.schema;
            return e instanceof x
              ? t.every(function (t) {
                  return null != Q(t, n);
                })
              : null != Q(t, n);
          })(n, r))
      )
        throw new Error('An item being assigned to the property [' + e + '] does not have a valid identifier');
      T(s, a(a({}, t), (((o = {})[e] = n), o)), i);
    } else {
      if (p(f) || f == e)
        if (Q(t, i) != Q(a(a({}, t), (((u = {})[e] = n), u)), i))
          throw new Error('This update is not allowed because the resolved id is different from the original value');
      s.commit(c + '/' + g.SET_PROP, { id: t._id, key: e, value: n, schema: i });
    }
  }
  function q(t, e) {
    var n = R(t),
      i = n._namespace,
      o = n._store,
      a = n._fields,
      u = a[e] instanceof D,
      s = u ? a[e] : null,
      c = t._load;
    Object.defineProperty(t, e, {
      enumerable: !c || !u || c.has(e),
      get: function () {
        var r = this;
        if (t._connected) {
          if (c && u && !c.has(e)) return;
          var a = o.getters[i + '/' + A.GET_RAW](t._id, n),
            f = a[e];
          if (u) {
            var l = { load: null == c ? void 0 : c.getLoad(e) },
              h = s.schema;
            if (s instanceof x)
              return (
                s instanceof I &&
                  (f = s.schema
                    .all(l)
                    .filter(function (t) {
                      return t[s.foreignKey] == r._id;
                    })
                    .map(function (t) {
                      return Q(t, s.schema);
                    })),
                f ? ((f = h.findByIds(f, l)), l.load && (f = l.load.apply(f)), f && new F()._init(t, e, f)) : void 0
              );
            if (s instanceof j) {
              if (!(null == a ? void 0 : a[s.foreignKey])) return;
              f = a[s.foreignKey];
            }
            return (f = h.find(f, l)), l.load ? l.load.apply(f) : f;
          }
          return a[e];
        }
        return t._caches[J(u)][e];
      },
      set: function (i) {
        t._connected
          ? z(t, e, i, s, n)
          : (function (t, e, n, i) {
              if (i) {
                var o = i.schema;
                (n = V(n, o)), i instanceof x && null != n && (n = Array.isArray(n) ? n : [n].filter(d));
              }
              r.default.set(t._caches[J(!!i)], e, n);
            })(t, e, i, s);
      },
    });
  }
  function Q(t, e) {
    return p(e.id) ? e.id(t, null, null) : t[e.id];
  }
  var X = (function () {
    function t(t, e) {
      var n = this;
      this._connected = !1;
      var i = t ? Q(t, R(this)) : null;
      Object.defineProperties(this, {
        _caches: {
          value: Object.fromEntries(
            H.map(function (t) {
              return [t, {}];
            })
          ),
        },
        _connected: { value: !!(null == e ? void 0 : e.connected), enumerable: !1, configurable: !0 },
        _load: { value: null == e ? void 0 : e.load, enumerable: !1, configurable: !0 },
        _id: { value: i, enumerable: !1, configurable: !1, writable: !0 },
      });
      var o,
        a,
        u = R(this)._fields;
      Object.keys(u).forEach(function (t) {
        q(n, t);
      }),
        this._connected ||
          ((o = this),
          void 0 === (a = t || {}) && (a = {}),
          Object.entries(R(o)._fields).forEach(function (t) {
            var e,
              n = l(t, 2),
              r = n[0],
              i = n[1];
            o._caches[J(i instanceof D)][r] = null !== (e = a[r]) && void 0 !== e ? e : i.default;
          }),
          r.default.observable(this._caches));
    }
    return (
      (t.prototype.toJSON = function (t, e) {
        var n = this,
          r = R(this);
        return Object.entries(this).reduce(function (t, i) {
          var o,
            a,
            u = l(i, 2),
            s = u[0],
            c = u[1];
          if (s in r._fields)
            if (r._fields[s] instanceof D) {
              var h = { item: n, parentNode: e };
              if (null == c) t[s] = c;
              else if (Array.isArray(c)) {
                var d = [];
                try {
                  for (var p = f(c), v = p.next(); !v.done; v = p.next()) {
                    var y = v.value;
                    d.push(y.toJSON ? (w(y, h) ? '>>> Recursive item <<<' : y.toJSON(s, h)) : y);
                  }
                } catch (t) {
                  o = { error: t };
                } finally {
                  try {
                    v && !v.done && (a = p.return) && a.call(p);
                  } finally {
                    if (o) throw o.error;
                  }
                }
                t[s] = d;
              } else t[s] = c.toJSON ? (w(c, h) ? '>>> Recursive item <<<' : c.toJSON(s, h)) : c;
            } else t[s] = c;
          return t;
        }, {});
      }),
      (t.prototype.$toObject = function (t) {
        return (
          void 0 === t && (t = !1),
          (function t(e, n, r, i) {
            void 0 === i && (i = new Map());
            var o = {};
            return (
              i.set(e, o),
              Object.entries(e).reduce(function (e, o) {
                var a,
                  u,
                  s = l(o, 2),
                  c = s[0],
                  h = s[1];
                if (c in n._fields) {
                  var d = n._fields[c];
                  if (d instanceof D) {
                    var p = d.schema;
                    if (null == h) e[c] = null;
                    else if (Array.isArray(h) && d instanceof x) {
                      var v = [];
                      try {
                        for (var y = f(h), _ = y.next(); !_.done; _ = y.next()) {
                          var m = _.value;
                          v.push(i.has(m) ? i.get(m) : t(m, p, r, i));
                        }
                      } catch (t) {
                        a = { error: t };
                      } finally {
                        try {
                          _ && !_.done && (u = y.return) && u.call(y);
                        } finally {
                          if (a) throw a.error;
                        }
                      }
                      e[c] = v;
                    } else e[c] = i.has(h) ? i.get(h) : t(h, p, r, i);
                  } else e[c] = h;
                }
                return e;
              }, o),
              o
            );
          })(this, R(this), t)
        );
      }),
      (t.prototype.$update = function (t) {
        return (
          void 0 === t && (t = {}),
          s(this, void 0, void 0, function () {
            var e,
              n = this;
            return c(this, function (r) {
              return [
                2,
                (e = R(this))._store
                  .dispatch(e._namespace + '/update', { id: this._id, data: t, schema: e })
                  .then(function (t) {
                    return (n._connected = !0), t;
                  }),
              ];
            });
          })
        );
      }),
      (t.prototype.$save = function () {
        return s(this, void 0, void 0, function () {
          var t = this;
          return c(this, function (e) {
            return [
              2,
              new Promise(function (e) {
                var n = R(t);
                if (t._connected) console.warn('No need calling $save');
                else {
                  var r = H.reduce(function (e, n) {
                    return a(a({}, e), t._caches[n]);
                  }, {});
                  e(
                    n._store.dispatch(n._namespace + '/' + b.ADD, { items: r, schema: n }).then(function (e) {
                      return (t._id = e), (t._connected = !0), e;
                    })
                  );
                }
              }),
            ];
          });
        });
      }),
      (t.prototype.$addRelated = function (t, e) {
        return s(this, void 0, void 0, function () {
          var n;
          return c(this, function (r) {
            return [
              2,
              (n = R(this))._store.dispatch(n._namespace + '/' + b.ADD_RELATED, {
                id: this._id,
                related: t,
                data: e,
                schema: n,
              }),
            ];
          });
        });
      }),
      (t.prototype.$removeRelated = function (t, e) {
        return s(this, void 0, void 0, function () {
          var n;
          return c(this, function (r) {
            return [
              2,
              (n = R(this))._store.dispatch(n._namespace + '/' + b.REMOVE_RELATED, {
                id: this._id,
                related: t,
                relatedId: e,
                schema: n,
              }),
            ];
          });
        });
      }),
      Object.defineProperty(t, 'fields', {
        get: function () {
          return {};
        },
        enumerable: !1,
        configurable: !0,
      }),
      (t.find = function (t, e) {
        return void 0 === e && (e = {}), this._store.getters[this._namespace + '/' + A.FIND](t, this, e);
      }),
      (t.findByIds = function (t, e) {
        return void 0 === e && (e = {}), this._store.getters[this._namespace + '/' + A.FIND_BY_IDS](t, this, e);
      }),
      (t.all = function (t) {
        return void 0 === t && (t = {}), this._store.getters[this._namespace + '/' + A.ALL](this, t);
      }),
      (t.add = function (t) {
        return this._store.dispatch(this._namespace + '/' + b.ADD, { items: t, schema: this });
      }),
      (t.addAll = function (t) {
        return this._store.dispatch(this._namespace + '/' + b.ADD, { items: t, schema: [this] });
      }),
      (t.$item = function (t) {
        var e = this;
        return nt.define(t, function () {
          return e;
        });
      }),
      (t.$list = function (t) {
        var e = this;
        return rt.define(t, function () {
          return e;
        });
      }),
      (t.$field = function (t) {
        return void 0 === t && (t = {}), et.define(t);
      }),
      (t.$belongsTo = function (t, e) {
        var n = this;
        return Y.define(
          t,
          function () {
            return n;
          },
          e
        );
      }),
      (t.$hasMany = function (t, e) {
        var n = this;
        return G.define(
          t,
          function () {
            return n;
          },
          e
        );
      }),
      (t.query = function (t) {
        var e = new W(this);
        return t && t(e), e;
      }),
      (t.id = 'id'),
      t
    );
  })();
  function Z(t, e) {
    var n, i, o;
    return {
      namespaced: !0,
      state: function () {
        return h(
          new Set(
            e.map(function (t) {
              return t.entityName;
            })
          )
        ).reduce(function (t, e) {
          return (t[e] = {}), t;
        }, {});
      },
      mutations:
        ((n = {}),
        (n[g.ADD_ALL] = function (t, e) {
          var n = e.items,
            r = e.schema.entityName;
          t[r] = a(
            a({}, t[r]),
            Object.fromEntries(
              Object.entries(n).map(function (e) {
                var n = l(e, 2),
                  i = n[0],
                  o = n[1];
                return [i, a(a({}, t[r][i]), o)];
              })
            )
          );
        }),
        (n[g.SET_PROP] = function (t, e) {
          var n = e.id,
            i = e.key,
            o = e.value,
            a = e.schema;
          if (null == t[a.entityName][n]) throw new Error('Entity does not exist');
          r.default.set(t[a.entityName][n], i, o);
        }),
        n),
      actions:
        ((i = {}),
        (i[b.ADD] = function (e, n) {
          var r = n.items,
            i = n.schema;
          return T(t, r, i);
        }),
        (i[b.ADD_RELATED] = function (t, e) {
          var n,
            r = t.dispatch,
            i = t.getters,
            o = e.id,
            u = e.related,
            s = e.data,
            c = e.schema;
          if (!(u in c._fields && c._fields[u] instanceof D)) throw new Error('Unknown Relationship: [' + u + ']');
          var f = i[A.FIND](o, c);
          if (!f) throw new Error("The item doesn't exist");
          var l = c._fields[u];
          if (l instanceof x) {
            var v = (Array.isArray(s) ? s : [s]).filter(d);
            s = (function (t, e) {
              var n = p(e)
                  ? e
                  : function (t) {
                      return t[e];
                    },
                r = new Map();
              return (
                t.forEach(function (t) {
                  var e = n.call(null, t);
                  r.set(e, r.has(e) ? a(a({}, r.get(e)), t) : t);
                }),
                h(r.values())
              );
            })((s = f[u] || []).concat(v), function (t) {
              return Q(t, l.schema);
            });
          }
          return r(b.UPDATE, { id: o, data: ((n = {}), (n[u] = s), n), schema: c });
        }),
        (i[b.REMOVE_RELATED] = function (t, e) {
          var n,
            r = t.dispatch,
            i = t.getters,
            o = e.id,
            a = e.related,
            u = e.relatedId,
            s = e.schema;
          if (!(a in s._fields && s._fields[a] instanceof D)) throw new Error('Unknown Relationship: [' + a + ']');
          var c = Array.isArray(o) ? o : [o],
            f = i[A.FIND_BY_IDS](c, s);
          if (0 !== f.length) {
            var l = s._fields[a],
              h = l.schema;
            if (l instanceof x) {
              var d = u ? (Array.isArray(u) ? u : [u]) : [];
              return Promise.all(
                f.map(function (t) {
                  var e,
                    n = (d.length && t[a]) || [];
                  return r(b.UPDATE, {
                    id: o,
                    data:
                      ((e = {}),
                      (e[a] = n.filter(function (t) {
                        return !d.includes(Q(t, h));
                      })),
                      e),
                    schema: s,
                  });
                })
              );
            }
            return r(b.UPDATE, { id: o, data: ((n = {}), (n[a] = null), n), schema: s });
          }
          console.warn('Invalid id Provided');
        }),
        (i[b.UPDATE] = function (t, e) {
          var n = t.getters,
            r = t.dispatch,
            i = e.id,
            o = e.data,
            u = e.schema;
          if (null == i) throw new Error('Id to perform update must be defined');
          var s,
            c = Array.isArray(i) ? i : [i],
            f = n[A.FIND_BY_IDS](c, u).filter(d);
          if (f.length !== c.length) throw new Error('Invalid item to update');
          if (p(u.id)) {
            s = f.map(function (t) {
              return a(a({}, t), o);
            });
            var l = f.map(function (t) {
                return Q(t, u);
              }),
              h = s.map(function (t) {
                return Q(t, u);
              });
            if (
              l.some(function (t, e) {
                return t != h[e];
              })
            )
              throw new Error('Invalid Update: This would cause a change in the computed id.');
          } else {
            var v = u.id;
            s = f.map(function (t) {
              var e;
              return a(a(a({}, p(u.id) ? t : null), o), (((e = {})[v] = i), e));
            });
          }
          return r(b.ADD, { items: s, schema: [u] });
        }),
        i),
      getters:
        ((o = {}),
        (o[A.GET_RAW] = function (t) {
          return function (e, n) {
            return t[n.entityName][e];
          };
        }),
        (o[A.FIND] = function (t, e) {
          return function (t, n, r) {
            void 0 === r && (r = {});
            var i,
              o = e[A.GET_RAW](t, n);
            if (o)
              return (
                r.load &&
                  (i =
                    r.load instanceof U
                      ? r.load
                      : new U(
                          new P(function () {
                            return n;
                          })
                        ).parse(r.load)),
                (function (t, e, n) {
                  var r;
                  void 0 === n && (n = {});
                  var i = Q(e, t);
                  if (n.load) return new t(e, n);
                  tt.has(t) || tt.set(t, _());
                  var o = tt.get(t);
                  return null !== (r = o[i]) && void 0 !== r ? r : (o[i] = new t(e, n));
                })(n, o, { load: i, connected: !0 })
              );
          };
        }),
        (o[A.FIND_BY_IDS] = function (t, e) {
          return function (t, n, r) {
            return (
              void 0 === t && (t = []),
              void 0 === r && (r = {}),
              t
                .map(function (t) {
                  return e[A.FIND](t, n, r);
                })
                .filter(d)
            );
          };
        }),
        (o[A.ALL] = function (t, e) {
          return function (n, r) {
            return void 0 === r && (r = {}), e[A.FIND_BY_IDS](Object.keys(t[n.entityName]), n, r);
          };
        }),
        o),
    };
  }
  var tt = new Map();
  function et(t) {
    return (
      void 0 === t && (t = {}),
      function (e, n) {
        var r = e.constructor;
        null == r._fields && (r._fields = _()), n in r._fields || (r._fields[n] = et.define(t));
      }
    );
  }
  function nt(t) {
    return function (e, n) {
      var r = e.constructor;
      null == r._fields && (r._fields = _()),
        n in r._fields ||
          (r._fields[n] = nt.define(t, function () {
            return r;
          }));
    };
  }
  function rt(t) {
    return function (e, n, r) {
      var i = e.constructor;
      null == i._fields && (i._fields = _()),
        n in i._fields ||
          (i._fields[n] = rt.define(t, function () {
            return i;
          }));
    };
  }
  (window.modelCache = tt),
    (et.define = function (t) {
      return void 0 === t && (t = {}), new O(t);
    }),
    (nt.define = function (t, e) {
      return new P(t, e);
    }),
    (rt.define = function (t, e) {
      return new k(t);
    });
  var it = { schemas: [], namespace: 'database' };
  return (
    (t.BelongsTo = Y),
    (t.Field = et),
    (t.HasMany = G),
    (t.Item = nt),
    (t.List = rt),
    (t.Model = X),
    (t.generateDatabasePlugin = function (t) {
      var e = a(a({}, it), t),
        n = e.schemas,
        i = e.namespace;
      return function (t) {
        t.registerModule(i, Z(t, n)),
          n.forEach(function (e) {
            !(function (t, e, n) {
              t._fields || Object.defineProperty(t, '_fields', { value: _({}) }),
                e.state[n][t.entityName] || r.default.set(e.state[n], t.entityName, {}),
                'string' != typeof t.id || t.id in t._fields || (t._fields[t.id] = new O()),
                t.fields && Object.assign(t._fields, t.fields),
                Object.defineProperties(t, { _namespace: { value: n }, _store: { value: e } }),
                Object.freeze(t);
            })(e, t, i);
          });
      };
    }),
    t
  );
})({}, Vue);
